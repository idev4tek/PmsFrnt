<!-- ============================================================== -->
<!-- row -->
<!-- ============================================================== -->
<div fxLayout="row wrap">
    <!-- Card column -->
    <div fxFlex.gt-sm="100%" fxFlex="100">
        <mat-card>
            <mat-card-content>
                <mat-horizontal-stepper [linear]="isLinear">
                    <mat-step [stepControl]="firstFormGroup">
                        <!-- <mat-step [stepControl]="firstFormGroup"  [editable]="isEditable"> -->
                        <form>
                            <ng-template matStepLabel>Booking</ng-template>
                            <ng-container *ngTemplateOutlet="firstStepForm"></ng-container>

                            <div>
                                <button mat-raised-button color="warn" matStepperNext>Continue</button>
                            </div>
                        </form>
                    </mat-step>
                    <mat-step [stepControl]="secondFormGroup">
                        <form [formGroup]="secondFormGroup">
                            <ng-template matStepLabel>Payment Shedule</ng-template>
                            <ng-container *ngTemplateOutlet="secondStepForm"></ng-container>
                            <!-- <mat-form-field>
                                <input matInput placeholder="Address" formControlName="secondCtrl" required>
                            </mat-form-field> -->
                            <div>
                                <button mat-raised-button color="accent" matStepperPrevious>Back</button>
                                <button mat-raised-button color="warn" matStepperNext>Next</button>
                            </div>
                        </form>
                    </mat-step>
                    <mat-step>
                        <ng-template matStepLabel>Done</ng-template>
                        You are now done.
                        <div>
                            <button mat-raised-button color="accent" matStepperPrevious>Back</button>
                        </div>
                    </mat-step>
                </mat-horizontal-stepper>

            </mat-card-content>

        </mat-card>
    </div>
</div>
<!-- 
    
                            <div fxLayout="row wrap" fxFlexAlign="center" class="row">
                                
                                <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Last name, First name" required>
                                    </mat-form-field>
                                </div>
                                
                                <div fxFlex.gt-sm="100" fxFlex="100" class="m-t-10 m-b-10">
                                    <button mat-raised-button color="primary" (click)="openDialog()">Open Dialog
                                    </button>
                                </div>
                            </div>
 -->

<!-- <ng-container *ngTemplateOutlet="customerBuyerAdd"></ng-container> -->

<ng-template #firstStepForm>
    <mat-card-subtitle class="card_sub_heading">Unit Information:</mat-card-subtitle>
    <div fxLayout="row wrap" fxFlexAlign="center" class="row" [formGroup]="firstFormGroup">

        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Registration #." formControlName="rgst_nmbr" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Type:" formControlName="unt_typ_key" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Sub Type:" formControlName="unt_sub_typ" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Features:" formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Area:" formControlName="prd_area" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
            <mat-card-subtitle class="card_sub_heading">Price:</mat-card-subtitle>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Price per unit:" formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Payment Plan:" formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Base Price:" formControlName="prd_bs_prc" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <a mat-button color="primary"> <u>Distribution</u></a> &nbsp;
            <a mat-button color="primary"> <u>Segregation</u></a>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Charges:" formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Discount:" formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Net Payable:" formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
            <mat-card-subtitle class="card_sub_heading">Customer/Buyer:</mat-card-subtitle>
        </div>
        <div fxFlex.gt-sm="100" fxFlex="100" fxLayoutAlign="end start" class="m-t-10 m-b-10">
            <button mat-raised-button color="primary" (click)="openDialog()">+ Add
            </button>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="CNIC #." formControlName="firstCtrl" required>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Name:" formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Father/Husband Name:" formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Mobile #." formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="DOB:" formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
            <mat-form-field>
                <input matInput placeholder="Present Address:" formControlName="firstCtrl" required readonly>
            </mat-form-field>
        </div>
        <mat-card-subtitle class="card_sub_heading">Charges:</mat-card-subtitle>
        <div fxFlex.gt-sm="100" fxFlex="100" fxLayoutAlign="end start" class="m-t-10 m-b-10">
            <button mat-raised-button color="primary" (click)="addCharge(addEditChargesDialog)">
                <mat-icon>add_circle_outline</mat-icon> Add
            </button>
        </div>
        <!-- <ng-container class="row" *ngFor="let _l of l">
            <div fxFlex.gt-sm="100" fxLayout="row wrap" fxFlexAlign="center" class="row" fxFlex="100" class="p-10">
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Charge ID:" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Calculated Amount:" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Actual Amount" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Payment Scheme:" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Status:" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="75" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Description:" formControlName="firstCtrl" required>
                    </mat-form-field>
                </div>
            </div>
        </ng-container> -->

        <!-- <div fxFlex.gt-sm="100" fxFlex="100">
        <mat-card>
            <mat-card-content>
              <mat-card-title>Editable table</mat-card-title>
              <ngx-datatable #mydatatable class="material" [headerHeight]="50" [limit]="5" [columnMode]="'force'" 
              [footerHeight]="50" [rowHeight]="'auto'" [rows]="getFormArrayByFormGroup(firstFormGroup,'charges').value">
                <ngx-datatable-column name="Name">
                  <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-value="value" let-row="row">
                    <span title="Double click to edit" (dblclick)="editing[rowIndex + '-name'] = true" *ngIf="!editing[rowIndex + '-name']">
                      {{value}}
                    </span>
                    <input autofocus (blur)="updateValue($event, 'name', rowIndex)" *ngIf="editing[rowIndex+ '-name']" type="text" [value]="value"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Gender">
                  <ng-template ngx-datatable-cell-template let-rowIndex="rowIndex" let-row="row" let-value="value">
                    <span title="Double click to edit" (dblclick)="editing[rowIndex + '-gender'] = true" *ngIf="!editing[rowIndex + '-gender']">
                      {{value}}
                    </span>
                    <select *ngIf="editing[rowIndex + '-gender']" (change)="updateValue($event, 'gender', rowIndex)" [value]="value">
                      <option value="male">Male</option>
                      <option value="female">Female</option>
                    </select>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Age">
                  <ng-template ngx-datatable-cell-template let-value="value">
                    {{value}}
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
            </mat-card-content>
          </mat-card>
        </div> -->
        <!-- single line add button with heading
        <div fxFlex.gt-sm="100" fxLayout="row wrap" fxFlexAlign="center" class="row" fxFlex="100" class="p-10">
            <mat-card-subtitle fxFlex.gt-sm="25" class="card_sub_heading">Charges:</mat-card-subtitle>
            <div fxFlex.gt-sm="75" fxFlex="100" fxLayoutAlign="end start" class="m-t-10 m-b-10">
                <button mat-raised-button color="primary" (click)="openDialog()">+ Add
                </button>
            </div>
        </div> -->

        <!-- <div fxFlex.gt-sm="100" fxFlex="100">
            <mat-card>
                <mat-card-content>
                    <mat-card-title>Table dynamically changing the columns displayed</mat-card-title>
                    <div class="responsive-table">
                        <mat-table #table [dataSource]="rows">
                            <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumns">

                                <ng-container *ngIf="column!='action'; then tableColumFromData; else tableColumAction">
                                </ng-container>

                                <ng-template #tableColumFromData>
                                    <mat-header-cell *matHeaderCellDef> {{column}}
                                    </mat-header-cell>
                                    <mat-cell *matCellDef="let element">
                                        <span class="header-label">{{column}}:</span>
                                        {{element[column]}}
                                    </mat-cell>
                                </ng-template>
                                <ng-template #tableColumAction>
                                    <mat-header-cell *matHeaderCellDef> Action </mat-header-cell>
                                    <mat-cell *matCellDef="let element">
                                        <button mat-raised-button>Edit</button>
                                        <button mat-raised-button color="warn">delete</button>
                                    </mat-cell> 
                                    <mat-header-cell *matHeaderCellDef> Price Distribution </mat-header-cell>
                                    <mat-cell *matCellDef="let element">
                                        <button mat-raised-button>Edit</button>
                                        <button mat-raised-button color="warn">delete</button>
                                    </mat-cell>
                                </ng-template>
                            </ng-container>
                            <mat-header-row *matHeaderRowDef="columnsToDisplay"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: columnsToDisplay;"></mat-row>
                        </mat-table>
                    </div>

                </mat-card-content>
            </mat-card>
        </div> -->


        <div fxFlex.gt-sm="100" fxFlex="100" class="m-b-20">
            <table>
                <tr>
                    <th>Charge Id</th>
                    <th>Description</th>
                    <th>Calculate Amount</th>
                    <th>Actual Amount</th>
                    <th>Payment Scheme</th>
                    <th>Status</th>
                    <th>Distribution/Segregation</th>
                    <th>Action</th>
                </tr>
                <tr *ngFor="let charg of chargesArray; let i = index;">
                    <td>{{charg['chargeId']}}</td>
                    <td>{{charg['description']}}</td>
                    <td>{{charg['calculateAmount']}}</td>
                    <td>{{charg['actualAmount']}}</td>
                    <td>{{charg['paymentScheme']}}</td>
                    <td>{{charg['status']}}</td>
                    <td>
                        <a mat-button color="primary" (click)="openSegrigationDialog(addDistributionDialog,charg)">
                            <u>Distribution</u></a> &nbsp;
                        <a mat-button color="primary" (click)="openSegrigationDialog(addSegregationDialog,charg)">
                            <u>Segregation</u></a>
                    </td>
                    <td>
                        <a mat-button (click)="addCharge(addEditChargesDialog,i)">
                            <mat-icon>edit</mat-icon>
                        </a>&nbsp;
                        <a mat-button color="warn" (click)="deleteCharges(i)">
                            <mat-icon>delete</mat-icon>
                        </a>
                    </td>
                </tr>
            </table>
        </div>

        <mat-card-subtitle class="card_sub_heading">Down Payment/Discount:</mat-card-subtitle>
        <div fxFlex.gt-sm="100" fxFlex="100" fxLayoutAlign="end start" class="m-t-10 m-b-10">
            <button mat-raised-button color="primary" (click)="addDiscount(addEditDiscountDialog)">
                <mat-icon>add_circle_outline</mat-icon> Add
            </button>
        </div>

        <div fxFlex.gt-sm="100" fxFlex="100" class="m-b-20">
            <table>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Calculate Amount</th>
                    <th>Actual Amount</th>
                    <th>Status</th>
                    <th>Distribution/Segregation</th>
                    <th>Action</th>
                </tr>
                <tr *ngFor="let disco of discountsArray; let i = index;">
                    <td>{{disco['id']}}</td>
                    <td>{{disco['name']}}</td>
                    <td>{{disco['calculateAmount']}}</td>
                    <td>{{disco['actualAmount']}}</td>
                    <td>{{disco['status']}}</td>
                    <td>
                        <a mat-button color="primary" (click)="openSegrigationDialog(addDistributionDialog,disco)">
                            <u>Distribution</u></a> &nbsp;
                        <a mat-button color="primary" (click)="openSegrigationDialog(addSegregationDialog,disco)">
                            <u>Segregation</u></a>
                    </td>
                    <td>
                        <a mat-button (click)="addDiscount(addEditDiscountDialog,i)">
                            <mat-icon>edit</mat-icon>
                        </a>&nbsp;
                        <a mat-button color="warn" (click)="deleteDiscount(i)">
                            <mat-icon>delete</mat-icon>
                        </a>
                    </td>
                </tr>
            </table>
        </div>

    </div>
</ng-template>

<ng-template #secondStepForm>
    <mat-card-subtitle class="card_sub_heading">Down Payment/Discount:</mat-card-subtitle>

    <div fxLayout="row wrap" fxFlexAlign="center" class="row" [formGroup]="secondFormGroup">
        <div fxFlex.gt-sm="100" fxFlex="100" fxLayoutAlign="end start" class="m-t-10 m-b-10">
            <button mat-raised-button color="primary" (click)="openDialog()">+ Add
            </button>
        </div>
        <ng-container class="row" *ngFor="let _l of l">
            <div fxFlex.gt-sm="100" fxLayout="row wrap" fxFlexAlign="center" class="row" fxFlex="100" class="p-10">
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Installment #." formControlName="secondCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Dege:" formControlName="secondCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Due Date:" formControlName="secondCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <input matInput placeholder="Due Amount:" formControlName="secondCtrl" required>
                    </mat-form-field>
                </div>
                <div fxFlex.gt-sm="100" fxFlex="100" fxLayoutAlign="end start" class="p-10">
                    <div fxLayout="row wrap" fxFlexAlign="center" class="row">
                        <button mat-raised-button color="warn" (click)="openDialog()">delete
                        </button>
                    </div>
                </div>
            </div>
        </ng-container>
    </div>
</ng-template>

<ng-template #customerBuyerAdd>
    <!-- ============================================================== -->
    <!-- Card Grid-->
    <!-- ============================================================== -->
    <div fxLayout="row wrap">
        <div fxFlex.gt-sm="100" fxFlex="100">
            <mat-card>
                <mat-card-content>
                    <!-- <mat-card-title>Customer/Buyer</mat-card-title> -->
                    <!-- ============================================================== -->
                    <!-- column -->
                    <!-- ============================================================== -->
                    <form class="basic-form">
                        <div fxLayout="row wrap" fxFlexAlign="center" class="row" [formGroup]="addCustomerFormGroup">
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput (keypress)="onlyNumbers($event)" formControlName="cnic_nmbr"
                                        placeholder="CNIC #.">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <mat-label>Exp Date:</mat-label>
                                    <input matInput [matDatepicker]="dp3" formControlName="cnic_expry_dt" disabled>
                                    <mat-hint>MM/DD/YYYY</mat-hint>
                                    <mat-datepicker-toggle matSuffix [for]="dp3"></mat-datepicker-toggle>
                                    <mat-datepicker #dp3 disabled="false"></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Name:" (keypress)="onlyLetters($event)"
                                        formControlName="cust_nm">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Father/Husband Name:" (keypress)="onlyLetters($event)"
                                        formControlName="fathr_hsbnd_nm">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Customer Id:" formControlName="cust_id">
                                </mat-form-field>
                            </div>
                            <ng-container formGroupName="preasent_address">
                                <!-- column -->
                                <div fxFlex.gt-sm="75" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Present Address:" formControlName="address">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="House #." formControlName="hse_nmbr">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Street Name:" formControlName="strt_nm">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="City:" formControlName="cty_key">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="State:" formControlName="stt_key">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Country:" formControlName="cntry_key">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Other Details:" formControlName="oth_dtl">
                                    </mat-form-field>
                                </div>
                            </ng-container>
                            <!-- column -->
                            <mat-card-subtitle class="card_sub_heading">Payment Address:</mat-card-subtitle>
                            <div fxFlex.gt-sm="100" fxFlex="100" class="m-t-10 m-b-10">
                                <mat-checkbox color="primary" class="m-r-10" placeholder="Checkbox">Same as above
                                </mat-checkbox>
                                <button mat-raised-button color="primary"
                                    (click)="samePaymentAddress = !samePaymentAddress">Add Payment
                                    Address</button>
                            </div>
                            <div fxLayout="row wrap" fxFlex="100" *ngIf="!samePaymentAddress">
                                <!-- column -->
                                <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Payment Address">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="City">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="State">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Country">
                                    </mat-form-field>
                                </div>

                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Mobile #." formControlName="prm_phon_nmbr">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Home Phone #." formControlName="scndry_phon_nmbr">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <!-- <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Office Phone #." formControlName="cntry_key">
                                </mat-form-field>
                            </div> -->
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Email Address:" formControlName="email_addr">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <mat-label>DOB:</mat-label>
                                    <input matInput [matDatepicker]="dp4" formControlName="dob" disabled>
                                    <mat-hint>MM/DD/YYYY</mat-hint>
                                    <mat-datepicker-toggle matSuffix [for]="dp4"></mat-datepicker-toggle>
                                    <mat-datepicker #dp4 disabled="false"></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Nationality:" formControlName="nlty_key">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Passport #." formControlName="pspt_nmbr">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Issuing Country:" formControlName="pspt_isu_cntry">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <mat-label>Expiry Date:</mat-label>
                                    <input matInput [matDatepicker]="dp2" formControlName="pspt_expry_dt" disabled>
                                    <mat-hint>MM/DD/YYYY</mat-hint>
                                    <mat-datepicker-toggle matSuffix [for]="dp2"></mat-datepicker-toggle>
                                    <mat-datepicker #dp2 disabled="false"></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Occupation:" formControlName="occ_key">
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </mat-card-content>

                <mat-card-content>
                    <mat-card-title>Nomine:</mat-card-title>
                    <!-- ============================================================== -->
                    <!-- column -->
                    <!-- ============================================================== -->
                    <form class="basic-form">
                        <div fxLayout="row wrap" fxFlexAlign="center" class="row" [formGroup]="addCustomerFormGroup">
                            <!-- column -->
                            <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="CNIC #." formControlName="nom_cnic_nmbr">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Name" formControlName="nom_name">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput placeholder="Relation" formControlName="rltn_key">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <mat-card-subtitle class="card_sub_heading">Nominee Address:</mat-card-subtitle>
                            <div fxFlex.gt-sm="100" fxFlex="100" class="m-t-10 m-b-10">
                                <mat-checkbox color="primary" class="m-r-10" placeholder="Checkbox">Same as above
                                </mat-checkbox>
                                <button mat-raised-button color="primary"
                                    (click)="sameNomineeAddress = !sameNomineeAddress">Add Nominee
                                    Address</button>
                            </div>
                            <div fxLayout="row wrap" fxFlex="100" *ngIf="!sameNomineeAddress">
                                <!-- column -->
                                <div fxFlex.gt-sm="100" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Payment Address">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="City">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="State">
                                    </mat-form-field>
                                </div>
                                <!-- column -->
                                <div fxFlex.gt-sm="33.33" fxFlex="100" class="p-10">
                                    <mat-form-field>
                                        <input matInput placeholder="Country">
                                    </mat-form-field>
                                </div>

                            </div>
                        </div>
                    </form>
                </mat-card-content>

                <mat-card-content>
                    <mat-card-title>Customer Documents:</mat-card-title>
                    <!-- ============================================================== -->
                    <!-- column -->
                    <!-- ============================================================== -->
                    <form class="basic-form">
                        <div fxLayout="row wrap" fxFlexAlign="center" class="row" [formGroup]="addCustomerFormGroup">
                            <!-- column -->
                            <div fxFlex.gt-sm="33" fxFlex="100" class="p-10">
                                <label for="">Upload Picture
                                    <input class="form-control b-b" placeholder="Upload picture" type="file">
                                </label>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="33" fxFlex="100" class="p-10">
                                <label for="">CNIC :
                                    <input class="form-control b-b" placeholder="CNIC Front Side" type="file">
                                </label>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="34" fxFlex="100" class="p-10">
                                <label for="">Scanned Declaration (Signed Document)
                                    <input class="form-control b-b" placeholder="Scanned Declaration" type="file">
                                </label>
                            </div>
                        </div>
                    </form>
                </mat-card-content>
            </mat-card>
        </div>
    </div>
</ng-template>

<ng-template #customerBuyerDialog>
    <h2 mat-dialog-title>Customer/Buyer</h2>
    <mat-dialog-content class="mat-typography">
        <ng-container *ngTemplateOutlet="customerBuyerAdd"></ng-container>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-button mat-dialog-close>Cancel</button>
        <button mat-button [mat-dialog-close]="true" cdkFocusInitial (click)='BuyerSave()'>Save</button>
    </mat-dialog-actions>

</ng-template>

<ng-template #addEditCharges>
    <!-- ============================================================== -->
    <!-- Card Grid-->
    <!-- ============================================================== -->
    <div fxLayout="row wrap">
        <div fxFlex.gt-sm="100" fxFlex="100">
            <mat-card>
                <mat-card-content>
                    <!-- <mat-card-title>Customer/Buyer</mat-card-title> -->
                    <!-- ============================================================== -->
                    <!-- column -->
                    <!-- ============================================================== -->
                    <form class="basic-form" [formGroup]="chargesFormGroup">
                        <div fxLayout="row wrap" fxFlexAlign="center" class="row">
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput (keypress)="onlyNumbers($event)" formControlName="chargeId" readonly
                                        placeholder="Charge Id:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput (keypress)="onlyLetters($event)" formControlName="description"
                                        placeholder="Description:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="calculateAmount" appCurrencyMask
                                        placeholder="Calculate Amount:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="actualAmount" appCurrencyMask
                                        placeholder="Actual Amount:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="paymentScheme" placeholder="Payment Scheme:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="status" placeholder="Status:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="index" placeholder="index:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="dst">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="sgr">
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </mat-card-content>
            </mat-card>
        </div>
    </div>
</ng-template>

<ng-template #addEditChargesDialog>
    <h2 mat-dialog-title>Customer/Buyer</h2>
    <mat-dialog-content class="mat-typography">
        <ng-container *ngTemplateOutlet="addEditCharges"></ng-container>
    </mat-dialog-content>
    <mat-dialog-actions align="end" *ngIf="chargesFormGroup.valid">
        <button mat-button mat-dialog-close>Cancel</button>
        <button mat-button [mat-dialog-close]="true" cdkFocusInitial (click)='updateCharges()'>Save</button>
    </mat-dialog-actions>

</ng-template>



<ng-template #addEditDiscount>
    <!-- ============================================================== -->
    <!-- Card Grid-->
    <!-- ============================================================== -->
    <div fxLayout="row wrap">
        <div fxFlex.gt-sm="100" fxFlex="100">
            <mat-card>
                <mat-card-content>
                    <!-- <mat-card-title>Customer/Buyer</mat-card-title> -->
                    <!-- ============================================================== -->
                    <!-- column -->
                    <!-- ============================================================== -->
                    <form class="basic-form" [formGroup]="discountsFormGroup">
                        <div fxLayout="row wrap" fxFlexAlign="center" class="row">
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput (keypress)="onlyNumbers($event)" formControlName="id" readonly
                                        placeholder="Id:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput (keypress)="onlyLetters($event)" formControlName="name"
                                        placeholder="Name:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="calculateAmount" appCurrencyMask
                                        placeholder="Calculate Amount:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="actualAmount" appCurrencyMask
                                        placeholder="Actual Amount:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field>
                                    <input matInput formControlName="status" placeholder="Status:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="index" placeholder="index:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="dst" placeholder="index:">
                                </mat-form-field>
                            </div>
                            <!-- column -->
                            <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                                <mat-form-field [class.cdk-visually-hidden]="true">
                                    <input matInput formControlName="sgr" placeholder="index:">
                                </mat-form-field>
                            </div>
                        </div>
                    </form>
                </mat-card-content>
            </mat-card>
        </div>
    </div>
</ng-template>

<ng-template #addEditDiscountDialog>
    <h2 mat-dialog-title>Down Payment/Discount</h2>
    <mat-dialog-content class="mat-typography">
        <ng-container *ngTemplateOutlet="addEditDiscount"></ng-container>
    </mat-dialog-content>
    <mat-dialog-actions align="end" *ngIf="discountsFormGroup.valid">
        <button mat-button mat-dialog-close>Cancel</button>
        <button mat-button [mat-dialog-close]="true" cdkFocusInitial (click)='updateDiscounts()'>Save</button>
    </mat-dialog-actions>

</ng-template>

<ng-template #addDistributionDialog let-data>
    <h2 mat-dialog-title>Distribution</h2>
    <mat-dialog-content class="mat-typography">
        <div fxLayout="row wrap" fxFlexAlign="center" class="row">
            <ng-container *ngFor="let dst of data.dst">
                <!-- <span *ngIf="dst.prd_ip_typ_key==1">Yearly</span>
                <span *ngIf="dst.prd_ip_typ_key==2">Bi-anually</span>
                <span *ngIf="dst.prd_ip_typ_key==3">Quarterly</span>
                <span *ngIf="dst.prd_ip_typ_key==4">Monthly</span>
                -->
                <!-- column -->
                <div fxFlex.gt-sm="25" fxFlex="100" class="p-10">
                    <mat-form-field>
                        <mat-label *ngIf="dst.prd_ip_typ_key==1">Yearly:</mat-label>
                        <mat-label *ngIf="dst.prd_ip_typ_key==2">Bi-anually:</mat-label>
                        <mat-label *ngIf="dst.prd_ip_typ_key==3">Quarterly:</mat-label>
                        <mat-label *ngIf="dst.prd_ip_typ_key==4">Monthly:</mat-label>

                        <input matInput [(ngModel)]="dst.prd_ip_typ_prcnt_vlu" (keypress)="onlyNumbers($event)"
                            (ngModelChange)="updateSegrigatoinValueViaDistribution(data.sgr,dst.prd_ip_typ_key,dst.prd_ip_typ_prcnt_vlu)">
                    </mat-form-field>
                </div>

                <!-- <mat-slider #slidey color="primary" [(ngModel)]="dst.prd_ip_typ_prcnt_vlu"  (keypress)="onlyNumbers($event)" 
                (ngModelChange)="updateSegrigatoinValueViaDistribution(data.sgr,dst.prd_ip_typ_key,dst.prd_ip_typ_prcnt_vlu)">
            </mat-slider> -->
                <!-- {{slidey.value}} <br> -->
            </ng-container>
        </div>

        <mat-chip-list *ngIf="!distributionSum100(data.dst)">
            <mat-chip color="warn" selected="true">Sum of all values should be 100</mat-chip>
        </mat-chip-list>
    </mat-dialog-content>
    <mat-dialog-actions align="end" *ngIf="distributionSum100(data.dst)">
        <button mat-button mat-dialog-close (click)='logChanges()'>Save</button>
    </mat-dialog-actions>
</ng-template>

<ng-template #addSegregationDialog let-data>
    <h2 mat-dialog-title>Segregation</h2>
    <mat-dialog-content class="mat-typography">
        <ng-container *ngFor="let sgr of data.sgr">
            <br *ngIf="sgr.inst_nmbr ==1">
            <br *ngIf="sgr.inst_nmbr ==1">
            <ng-container *ngIf="sgr.code ==1 && SegregationVaisibilityViaDistribution(data.dst,sgr.code)">
                <mat-checkbox class="example-margin" (change)="fun(sgr)" [checked]="check(sgr.prd_ip_typ_key)">
                    Anual {{ sgr.inst_nmbr }} </mat-checkbox>
            </ng-container>
            <ng-container *ngIf="sgr.code ==2 && SegregationVaisibilityViaDistribution(data.dst,sgr.code)">
                <mat-checkbox class="example-margin" (change)="fun(sgr)" [checked]="check(sgr.prd_ip_typ_key)">
                    Bi-year {{ sgr.inst_nmbr }} </mat-checkbox>
            </ng-container>
            <ng-container *ngIf="sgr.code ==3 && SegregationVaisibilityViaDistribution(data.dst,sgr.code)">
                <mat-checkbox class="example-margin" (change)="fun(sgr)" [checked]="check(sgr.prd_ip_typ_key)">
                    Quarter {{ sgr.inst_nmbr }} </mat-checkbox>
            </ng-container>
            <ng-container *ngIf="sgr.code ==4 && SegregationVaisibilityViaDistribution(data.dst,sgr.code)">
                <mat-checkbox class="example-margin" (change)="fun(sgr)" [checked]="check(sgr.prd_ip_typ_key)">
                    Month {{ sgr.inst_nmbr }} </mat-checkbox>
            </ng-container>

        </ng-container>
    </mat-dialog-content>
    <!-- <code>{{data|json }}</code> -->
    <mat-dialog-actions align="end">
        <button mat-button mat-dialog-close>Cancel</button>
        <button mat-button [mat-dialog-close]="true" cdkFocusInitial (click)='logChanges()'>Save</button>
    </mat-dialog-actions>
</ng-template>